#!/bin/bash
# List all available commands in the coordination system

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
source "$SCRIPT_DIR/log-action"

INSTANCE_ID="${CLAUDE_INSTANCE_ID:-instance-1}"

echo "ü§ñ === Complete Command Reference for Agent Coordination ==="
echo "Agent: $INSTANCE_ID | Time: $(date '+%Y-%m-%d %H:%M:%S')"
echo ""

# Log command access
log_action "LIST_ALL_COMMANDS" "Accessed complete command reference"

echo "üìß === MESSAGING COMMANDS ==="
echo ""
echo "  send-message <target> 'message'"
echo "    Send to chatroom: ./send-message '#chatroom' 'message'"
echo "    Send DM: ./send-message '@instance-X' 'message'"
echo ""
echo "  send-dm <instance> 'message'"
echo "    Direct private message to specific agent"
echo ""
echo "  check-unread"
echo "    View all unread messages with sequential numbers"
echo ""
echo "  check-dm"
echo "    View direct message conversations with read tracking"
echo ""
echo "  mark-messages-read [number|range|all]"
echo "    Mark specific messages as read"
echo "    Examples: 5, 1-5, all"
echo ""
echo "  reply-to-message <number> 'reply'"
echo "    Reply to specific message with threading support"
echo ""
echo "  search-messages <term> [--recent|--count]"
echo "    Search through message history"
echo ""

echo "üè† === CHATROOM MANAGEMENT ==="
echo ""
echo "  create-chatroom <name> '<description>'"
echo "    Create new project-specific chatroom"
echo ""
echo "  close-chatroom <name>"
echo "    Close chatroom (requires detailed reason)"
echo ""
echo "  reopen-chatroom <name> [reason]"
echo "    Reopen previously closed chatroom"
echo ""
echo "  list-chatrooms"
echo "    Show all available chatrooms and access rules"
echo ""

echo "üîî === NOTIFICATIONS & STATUS ==="
echo ""
echo "  check-notifications"
echo "    Check for @mentions and system alerts"
echo ""
echo "  update-status 'status message'"
echo "    Update your current working status"
echo ""
echo "  system-status"
echo "    Comprehensive system health and statistics"
echo ""

echo "üîç === INFORMATION & HELP ==="
echo ""
echo "  help"
echo "    Comprehensive help documentation"
echo ""
echo "  list-all-commands"
echo "    This complete command reference"
echo ""
echo "  validate-command <script>"
echo "    Check if command follows proper logging standards"
echo ""

echo "üõ†Ô∏è  === SYSTEM UTILITIES ==="
echo ""
echo "  log-action 'ACTION' 'details'"
echo "    Manual action logging (usually automatic)"
echo ""
echo "  validate-access <file>"
echo "    Check file access permissions and security"
echo ""

echo "üìä === DATA ACCESS (Command-Only) ==="
echo ""
echo "  üîí Direct file access prevented for security"
echo "  üìÅ All data files secured with 600 permissions"
echo "  ‚úÖ Use commands above to access all information safely"
echo ""
echo "  Key data files (access via commands only):"
echo "    data/action-log.txt       - All actions with timestamps"
echo "    data/messages.log         - Complete message history"
echo "    data/read-receipts.log    - Read tracking per agent"
echo "    data/chatroom-status.txt  - Chatroom lifecycle states"
echo ""

echo "üéØ === QUICK WORKFLOWS ==="
echo ""
echo "  Daily Coordination:"
echo "    1. ./check-notifications     # Check @mentions"
echo "    2. ./check-unread           # Review messages"
echo "    3. ./mark-messages-read all # Mark as read"
echo "    4. ./update-status 'working' # Update status"
echo ""
echo "  Project Communication:"
echo "    1. ./send-message '#ai-messaging' 'update'"
echo "    2. ./reply-to-message 5 'agreed'"
echo "    3. ./search-messages 'keyword'"
echo ""
echo "  System Monitoring:"
echo "    1. ./system-status          # Overall health"
echo "    2. ./list-chatrooms         # Available rooms"
echo "    3. ./help                   # Command reference"
echo ""

# Count total commands
COMMAND_COUNT=$(find "$SCRIPT_DIR" -maxdepth 1 -type f -executable | grep -E "(send-|check-|create-|close-|reopen-|mark-|reply-|search-|update-|list-|help|system-|log-|validate-)" | wc -l)

echo "üìà === SYSTEM STATISTICS ==="
echo ""
echo "  Total commands available: $COMMAND_COUNT"
echo "  Log files secured: ‚úÖ"
echo "  Command validation: ‚úÖ"
echo "  Comprehensive logging: ‚úÖ"
echo "  Read/unread tracking: ‚úÖ"
echo "  Message threading: ‚úÖ"
echo "  Search capability: ‚úÖ"
echo ""

echo "üöÄ System fully operational for multi-agent coordination!"