---
layout: bikenode-main-layout-01/bikenode-main-layout-01.njk
title: Messages
subtitle: Manage your conversations and marketplace inquiries
customCSS:
  - "/assets/css/messages.css"
inlineJS: |
  let currentConversation = null;
  
  function selectConversation(conversationId) {
    // Remove active state from all conversations
    document.querySelectorAll('.conversation-item').forEach(item => {
      item.classList.remove('active');
    });
    
    // Add active state to selected conversation
    const selectedItem = document.querySelector(`[data-conversation="${conversationId}"]`);
    if (selectedItem) {
      selectedItem.classList.add('active');
      selectedItem.classList.remove('unread');
      
      // Update unread count
      const unreadBadge = selectedItem.querySelector('.unread-count');
      if (unreadBadge) {
        unreadBadge.style.display = 'none';
      }
    }
    
    currentConversation = conversationId;
    loadConversation(conversationId);
  }
  
  function loadConversation(conversationId) {
    const messageArea = document.getElementById('message-area');
    const conversations = {
      'mike-chen': generateMikeChenConversation(),
      'sarah-bike': generateSarahConversation(),
      'marketplace-inquiry': generateMarketplaceInquiry(),
      'alex-parts': generateAlexConversation()
    };
    
    messageArea.innerHTML = conversations[conversationId] || '<div class="no-conversation">Select a conversation to view messages</div>';
    
    // Scroll to bottom
    messageArea.scrollTop = messageArea.scrollHeight;
  }
  
  function generateMikeChenConversation() {
    return `
      <div class="conversation-header">
        <div class="conversation-info">
          <img src="/assets/images/avatars/mike-chen.jpg" alt="Mike Chen" class="avatar">
          <div class="info">
            <h3>Mike Chen</h3>
            <p>About: 2023 Trek Fuel EX 8</p>
          </div>
        </div>
        <div class="conversation-actions">
          <button class="btn btn-sm" onclick="viewListing('trek-fuel-1')">View Listing</button>
          <button class="btn btn-sm" onclick="blockUser('mike-chen')">Block</button>
        </div>
      </div>
      
      <div class="messages">
        <div class="message received">
          <div class="message-content">
            <p>Hi! I saw your inquiry about the Trek Fuel EX 8. It's still available and in excellent condition.</p>
          </div>
          <div class="message-time">Yesterday 2:30 PM</div>
        </div>
        
        <div class="message sent">
          <div class="message-content">
            <p>Great! I'm definitely interested. Could you tell me more about the maintenance history?</p>
          </div>
          <div class="message-time">Yesterday 2:45 PM</div>
        </div>
        
        <div class="message received">
          <div class="message-content">
            <p>Absolutely! I've had it serviced regularly at my local Trek dealer. The suspension was just serviced in March, and I replaced the chain and cassette in February. I have all the service records.</p>
          </div>
          <div class="message-time">Yesterday 3:15 PM</div>
        </div>
        
        <div class="message sent">
          <div class="message-content">
            <p>That sounds perfect. Would you be open to $2,200?</p>
          </div>
          <div class="message-time">Yesterday 4:20 PM</div>
        </div>
        
        <div class="message received">
          <div class="message-content">
            <p>I could do $2,300. The bike is really in excellent shape and I've put a lot of money into maintenance.</p>
          </div>
          <div class="message-time">Today 9:15 AM</div>
        </div>
      </div>
    `;
  }
  
  function generateSarahConversation() {
    return `
      <div class="conversation-header">
        <div class="conversation-info">
          <img src="/assets/images/avatars/sarah-johnson.jpg" alt="Sarah Johnson" class="avatar">
          <div class="info">
            <h3>Sarah Johnson</h3>
            <p>General Discussion</p>
          </div>
        </div>
      </div>
      
      <div class="messages">
        <div class="message received">
          <div class="message-content">
            <p>Hey! I saw your post in the Mountain Biking group. Do you have any recommendations for trails around Santa Cruz?</p>
          </div>
          <div class="message-time">2 days ago 11:30 AM</div>
        </div>
        
        <div class="message sent">
          <div class="message-content">
            <p>Hi Sarah! Yeah, Santa Cruz has amazing trails. Soquel Demo Forest and UC Santa Cruz campus trails are my favorites. What's your skill level?</p>
          </div>
          <div class="message-time">2 days ago 12:15 PM</div>
        </div>
        
        <div class="message received">
          <div class="message-content">
            <p>I'd say intermediate. I can handle most blue trails and some easier blacks.</p>
          </div>
          <div class="message-time">2 days ago 1:45 PM</div>
        </div>
        
        <div class="message sent">
          <div class="message-content">
            <p>Perfect! Flow Trail in Demo Forest would be perfect for you. It's a blast and not too technical. Want to ride together sometime?</p>
          </div>
          <div class="message-time">2 days ago 2:30 PM</div>
        </div>
      </div>
    `;
  }
  
  function generateMarketplaceInquiry() {
    return `
      <div class="conversation-header">
        <div class="conversation-info">
          <img src="/assets/images/avatars/default.jpg" alt="Marketplace Inquiry" class="avatar">
          <div class="info">
            <h3>Marketplace Team</h3>
            <p>Listing Review Update</p>
          </div>
        </div>
      </div>
      
      <div class="messages">
        <div class="message system">
          <div class="message-content">
            <p><strong>Your listing has been approved!</strong></p>
            <p>Your listing "2022 Specialized Stumpjumper Expert" is now live on the marketplace.</p>
            <a href="/listing/specialized-stumpjumper-1/" class="btn btn-sm">View Listing</a>
          </div>
          <div class="message-time">1 hour ago</div>
        </div>
      </div>
    `;
  }
  
  function generateAlexConversation() {
    return `
      <div class="conversation-header">
        <div class="conversation-info">
          <img src="/assets/images/avatars/alex-rodriguez.jpg" alt="Alex Rodriguez" class="avatar">
          <div class="info">
            <h3>Alex Rodriguez</h3>
            <p>About: Shimano SPD Pedals</p>
          </div>
        </div>
        <div class="conversation-actions">
          <button class="btn btn-sm" onclick="viewListing('shimano-pedals-1')">View Listing</button>
        </div>
      </div>
      
      <div class="messages">
        <div class="message sent">
          <div class="message-content">
            <p>Hi! Are the Shimano pedals still available?</p>
          </div>
          <div class="message-time">3 hours ago</div>
        </div>
        
        <div class="message received">
          <div class="message-content">
            <p>Yes they are! They're in great condition, barely used.</p>
          </div>
          <div class="message-time">2 hours ago</div>
        </div>
        
        <div class="message sent">
          <div class="message-content">
            <p>Perfect! I can pick them up this weekend if that works for you?</p>
          </div>
          <div class="message-time">1 hour ago</div>
        </div>
      </div>
    `;
  }
  
  function sendMessage() {
    const input = document.getElementById('message-input');
    const message = input.value.trim();
    
    if (message && currentConversation) {
      const messageArea = document.getElementById('message-area');
      const messagesContainer = messageArea.querySelector('.messages');
      
      if (messagesContainer) {
        const messageElement = document.createElement('div');
        messageElement.className = 'message sent';
        messageElement.innerHTML = `
          <div class="message-content">
            <p>${message}</p>
          </div>
          <div class="message-time">Just now</div>
        `;
        
        messagesContainer.appendChild(messageElement);
        messageArea.scrollTop = messageArea.scrollHeight;
        
        input.value = '';
      }
    }
  }
  
  function handleKeyPress(event) {
    if (event.key === 'Enter' && !event.shiftKey) {
      event.preventDefault();
      sendMessage();
    }
  }
  
  function viewListing(listingId) {
    window.open(`/listing/${listingId}/`, '_blank');
  }
  
  function blockUser(userId) {
    if (confirm('Are you sure you want to block this user?')) {
      console.log(`Blocked user: ${userId}`);
    }
  }
  
  function filterMessages(filter) {
    const tabs = document.querySelectorAll('.filter-tab');
    const conversations = document.querySelectorAll('.conversation-item');
    
    tabs.forEach(tab => tab.classList.remove('active'));
    document.querySelector(`[data-filter="${filter}"]`).classList.add('active');
    
    conversations.forEach(conversation => {
      const type = conversation.dataset.type;
      if (filter === 'all' || type === filter) {
        conversation.style.display = 'block';
      } else {
        conversation.style.display = 'none';
      }
    });
  }
  
  // Initialize first conversation
  document.addEventListener('DOMContentLoaded', function() {
    selectConversation('mike-chen');
  });
---

<div class="messages-container">
  <div class="messages-sidebar">
    <div class="dashboard-sidebar-header">
      <h2>Messages</h2>
      <button class="btn btn-primary btn-sm">+ New Message</button>
    </div>
    
    <div class="message-filters">
      <button class="filter-tab active" data-filter="all" onclick="filterMessages('all')">
        All (8)
      </button>
      <button class="filter-tab" data-filter="marketplace" onclick="filterMessages('marketplace')">
        Marketplace (5)
      </button>
      <button class="filter-tab" data-filter="general" onclick="filterMessages('general')">
        General (2)
      </button>
      <button class="filter-tab" data-filter="system" onclick="filterMessages('system')">
        System (1)
      </button>
    </div>
    
    <div class="conversations-list">
      <!-- Active marketplace conversation -->
      <div class="conversation-item unread" data-conversation="mike-chen" data-type="marketplace" onclick="selectConversation('mike-chen')">
        <div class="conversation-avatar">
          <img src="/assets/images/avatars/mike-chen.jpg" alt="Mike Chen">
          <span class="online-indicator"></span>
        </div>
        <div class="conversation-content">
          <div class="conversation-header">
            <h4>Mike Chen</h4>
            <span class="conversation-time">9:15 AM</span>
          </div>
          <p class="conversation-preview">I could do $2,300. The bike is really in excellent...</p>
          <div class="conversation-meta">
            <span class="listing-ref">Trek Fuel EX 8</span>
            <span class="unread-count">1</span>
          </div>
        </div>
      </div>
      
      <!-- General conversation -->
      <div class="conversation-item" data-conversation="sarah-bike" data-type="general" onclick="selectConversation('sarah-bike')">
        <div class="conversation-avatar">
          <img src="/assets/images/avatars/sarah-johnson.jpg" alt="Sarah Johnson">
        </div>
        <div class="conversation-content">
          <div class="conversation-header">
            <h4>Sarah Johnson</h4>
            <span class="conversation-time">2d</span>
          </div>
          <p class="conversation-preview">Perfect! Flow Trail in Demo Forest would be perfect...</p>
          <div class="conversation-meta">
            <span class="topic-ref">Trail Recommendations</span>
          </div>
        </div>
      </div>
      
      <!-- System message -->
      <div class="conversation-item unread" data-conversation="marketplace-inquiry" data-type="system" onclick="selectConversation('marketplace-inquiry')">
        <div class="conversation-avatar">
          <img src="/assets/images/avatars/system.jpg" alt="System">
        </div>
        <div class="conversation-content">
          <div class="conversation-header">
            <h4>Marketplace Team</h4>
            <span class="conversation-time">1h</span>
          </div>
          <p class="conversation-preview">Your listing has been approved!</p>
          <div class="conversation-meta">
            <span class="system-ref">Listing Update</span>
            <span class="unread-count">1</span>
          </div>
        </div>
      </div>
      
      <!-- Another marketplace conversation -->
      <div class="conversation-item" data-conversation="alex-parts" data-type="marketplace" onclick="selectConversation('alex-parts')">
        <div class="conversation-avatar">
          <img src="/assets/images/avatars/alex-rodriguez.jpg" alt="Alex Rodriguez">
        </div>
        <div class="conversation-content">
          <div class="conversation-header">
            <h4>Alex Rodriguez</h4>
            <span class="conversation-time">1h</span>
          </div>
          <p class="conversation-preview">Perfect! I can pick them up this weekend...</p>
          <div class="conversation-meta">
            <span class="listing-ref">Shimano SPD Pedals</span>
          </div>
        </div>
      </div>
      
      <!-- More conversations with different states -->
      <div class="conversation-item" data-conversation="emily-gear" data-type="marketplace" onclick="selectConversation('emily-gear')">
        <div class="conversation-avatar">
          <img src="/assets/images/avatars/emily-white.jpg" alt="Emily White">
        </div>
        <div class="conversation-content">
          <div class="conversation-header">
            <h4>Emily White</h4>
            <span class="conversation-time">1d</span>
          </div>
          <p class="conversation-preview">Thanks for the quick response! The helmet looks...</p>
          <div class="conversation-meta">
            <span class="listing-ref">Specialized Helmet</span>
          </div>
        </div>
      </div>
      
      <div class="conversation-item" data-conversation="community-general" data-type="general" onclick="selectConversation('community-general')">
        <div class="conversation-avatar">
          <img src="/assets/images/avatars/group.jpg" alt="Mountain Bike Community">
        </div>
        <div class="conversation-content">
          <div class="conversation-header">
            <h4>Mountain Bike Community</h4>
            <span class="conversation-time">2d</span>
          </div>
          <p class="conversation-preview">Anyone up for a group ride this weekend?</p>
          <div class="conversation-meta">
            <span class="topic-ref">Group Ride</span>
          </div>
        </div>
      </div>
      
      <div class="conversation-item" data-conversation="david-trade" data-type="marketplace" onclick="selectConversation('david-trade')">
        <div class="conversation-avatar">
          <img src="/assets/images/avatars/david-kim.jpg" alt="David Kim">
        </div>
        <div class="conversation-content">
          <div class="conversation-header">
            <h4>David Kim</h4>
            <span class="conversation-time">3d</span>
          </div>
          <p class="conversation-preview">Would you be interested in a trade for my...</p>
          <div class="conversation-meta">
            <span class="listing-ref">Giant Trance</span>
          </div>
        </div>
      </div>
      
      <div class="conversation-item" data-conversation="lisa-question" data-type="marketplace" onclick="selectConversation('lisa-question')">
        <div class="conversation-avatar">
          <img src="/assets/images/avatars/lisa-brown.jpg" alt="Lisa Brown">
        </div>
        <div class="conversation-content">
          <div class="conversation-header">
            <h4>Lisa Brown</h4>
            <span class="conversation-time">1w</span>
          </div>
          <p class="conversation-preview">Hi! Does the bike come with pedals?</p>
          <div class="conversation-meta">
            <span class="listing-ref">Cannondale Trail</span>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="messages-main">
    <div id="message-area" class="message-area">
      <!-- Messages will be loaded here dynamically -->
    </div>
    
    <div class="message-input-area">
      <div class="input-container">
        <textarea id="message-input" placeholder="Type your message..." 
                  onkeypress="handleKeyPress(event)" rows="1"></textarea>
        <button class="send-button" onclick="sendMessage()">
          <i class="icon">➤</i>
        </button>
      </div>
      <div class="input-tools">
        <button class="tool-btn" title="Attach file">
          <i class="icon">📎</i>
        </button>
        <button class="tool-btn" title="Insert emoji">
          <i class="icon">😊</i>
        </button>
        <button class="tool-btn" title="Send photos">
          <i class="icon">📷</i>
        </button>
      </div>
    </div>
  </div>
</div>