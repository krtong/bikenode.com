<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Motorcycle Specs Integration</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .test-section {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #333;
        }
        
        h2 {
            color: #666;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }
        
        .test-bike {
            margin: 20px 0;
            padding: 15px;
            background: #f9f9f9;
            border-left: 4px solid #007bff;
        }
        
        .specs {
            margin-top: 10px;
            padding: 10px;
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .spec-item {
            display: flex;
            margin: 5px 0;
        }
        
        .spec-label {
            font-weight: bold;
            width: 150px;
            color: #555;
        }
        
        .spec-value {
            flex: 1;
            color: #333;
        }
        
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
        }
        
        button:hover {
            background: #0056b3;
        }
        
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
    </style>
</head>
<body>
    <h1>üèçÔ∏è Motorcycle Specs Integration Test</h1>
    
    <div class="test-section">
        <h2>Test Motorcycles with Specifications</h2>
        <p>Click on any motorcycle below to test the specs API endpoint:</p>
        
        <div id="test-bikes">
            <!-- Will be populated with test motorcycles -->
        </div>
    </div>
    
    <div class="test-section">
        <h2>Integration Test for Add-Bike Page</h2>
        <p>These are motorcycles that should show detailed specifications in the add-bike page:</p>
        
        <button onclick="openAddBikePage()">Open Add-Bike Page</button>
        <button onclick="testRandomMotorcycle()">Test Random Motorcycle</button>
        
        <div id="status-messages"></div>
    </div>
    
    <div class="test-section">
        <h2>API Test Results</h2>
        <pre id="api-results" style="background: #f5f5f5; padding: 15px; overflow-x: auto;"></pre>
    </div>

    <script>
        // Test motorcycles with known specs
        const testMotorcycles = [
            { id: '2e6cbfef-89c2-5d9f-92c7-e6fc0b898a36', year: 2022, make: 'Honda', model: 'Benly', specId: 1546 },
            { id: '8c5b2d02-554f-5726-bf51-6531f6fc210d', year: 2024, make: 'Harley-Davidson', model: 'CVO Road Glide', specId: 1385 },
            { id: 'f3a61d26-e9c3-5908-ad73-650c7f2d2b1a', year: 2025, make: 'BMW', model: 'C 400', specId: 478 },
            { id: 'f8698f33-f31e-57bc-8987-a2bcf430fee2', year: 2025, make: 'Triumph', model: 'Bonneville Speedmaster', specId: 3154 },
            { id: '03791632-bc57-58f8-a12a-15c72712d3fa', year: 2007, make: 'Yamaha', model: 'AG 200 E', specId: 3430 }
        ];
        
        function displayTestBikes() {
            const container = document.getElementById('test-bikes');
            container.innerHTML = '';
            
            testMotorcycles.forEach(bike => {
                const bikeDiv = document.createElement('div');
                bikeDiv.className = 'test-bike';
                bikeDiv.innerHTML = `
                    <h3>${bike.year} ${bike.make} ${bike.model}</h3>
                    <p>ID: ${bike.id}<br>Expected Spec ID: ${bike.specId}</p>
                    <button onclick="testMotorcycleSpecs('${bike.id}', '${bike.year} ${bike.make} ${bike.model}')">
                        Test Specs API
                    </button>
                    <div id="specs-${bike.id}" class="specs" style="display: none;"></div>
                `;
                container.appendChild(bikeDiv);
            });
        }
        
        async function testMotorcycleSpecs(motorcycleId, bikeName) {
            const specsDiv = document.getElementById(`specs-${motorcycleId}`);
            const resultsDiv = document.getElementById('api-results');
            
            try {
                specsDiv.style.display = 'block';
                specsDiv.innerHTML = '<p>Loading specifications...</p>';
                
                const response = await fetch(`http://localhost:8080/api/motorcycles/${motorcycleId}/specs`);
                const data = await response.json();
                
                resultsDiv.textContent = JSON.stringify(data, null, 2);
                
                if (data.hasSpecs) {
                    specsDiv.innerHTML = `
                        <h4>‚úÖ Specifications Found!</h4>
                        <div class="spec-item">
                            <span class="spec-label">Spec ID:</span>
                            <span class="spec-value">${data.specId}</span>
                        </div>
                        <div class="spec-item">
                            <span class="spec-label">Total Specs:</span>
                            <span class="spec-value">${Object.keys(data.specifications).length} fields</span>
                        </div>
                    `;
                    
                    // Show some key specs
                    const keySpecs = ['Engine', 'Capacity', 'Max Power', 'Max Torque', 'Transmission'];
                    keySpecs.forEach(key => {
                        if (data.specifications[key]) {
                            const specItem = document.createElement('div');
                            specItem.className = 'spec-item';
                            specItem.innerHTML = `
                                <span class="spec-label">${key}:</span>
                                <span class="spec-value">${data.specifications[key]}</span>
                            `;
                            specsDiv.appendChild(specItem);
                        }
                    });
                    
                    addStatus(`‚úÖ Successfully loaded specs for ${bikeName}`, 'success');
                } else {
                    specsDiv.innerHTML = `<p>‚ùå ${data.message || 'No specifications available'}</p>`;
                    addStatus(`‚ùå No specs found for ${bikeName}`, 'error');
                }
            } catch (error) {
                specsDiv.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
                resultsDiv.textContent = `Error: ${error.message}`;
                addStatus(`‚ùå Failed to load specs for ${bikeName}: ${error.message}`, 'error');
            }
        }
        
        function addStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status-messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `status ${type}`;
            messageDiv.textContent = message;
            statusDiv.appendChild(messageDiv);
            
            // Auto-remove after 5 seconds
            setTimeout(() => {
                messageDiv.remove();
            }, 5000);
        }
        
        function openAddBikePage() {
            addStatus('Opening add-bike page. Navigate to Motorcycle > Select a brand with specs (e.g., Honda, BMW, Triumph)', 'info');
            window.open('http://localhost:8081/add-bike/', '_blank');
        }
        
        function testRandomMotorcycle() {
            const randomBike = testMotorcycles[Math.floor(Math.random() * testMotorcycles.length)];
            testMotorcycleSpecs(randomBike.id, `${randomBike.year} ${randomBike.make} ${randomBike.model}`);
        }
        
        // Initialize
        displayTestBikes();
        addStatus('Test page loaded. Click on any motorcycle to test the specs API.', 'info');
    </script>
</body>
</html>